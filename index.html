<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>MathQuest â€” Mobile Refactor</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com"/>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin/>
  <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@400;600;700&display=swap" rel="stylesheet"/>

  <link rel="stylesheet" href="./style.css"/>

  <!-- MathJax v3 for LaTeX -->
  <script>
    window.MathJax = {
      tex: { inlineMath: [['\\(','\\)'], ['$', '$']], displayMath: [['\\[','\\]']] },
      options: { skipHtmlTags: { '[-]': [] } }
    };
  </script>
  <script async id="mathjax" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
  <header class="topbar">
    <div class="brand">MathQuest</div>

    <div class="hud">
      <div class="hud-info">
        <div class="hud-row">
          <div class="level">Lv <span id="hudLevel">1</span></div>
          <div class="xp-val"><span id="hudXP">0</span> XP</div>
        </div>
        <div class="xp-track"><div id="xpBar" class="xp-bar"></div></div>
        <div class="player-name">ðŸ‘¤ <span id="hudPlayerName">Player</span></div>
      </div>

      <div class="top-actions">
        <label class="theme-select-label">
          Theme
          <select id="themeSelect" class="theme-select" aria-label="Color theme">
            <option value="blue">Blue</option>
            <option value="pink">Pink</option>
            <option value="burgundy">Burgundy</option>
            <option value="green">Green</option>
            <option value="yellow">Yellow</option>
          </select>
        </label>
        <a class="btn small btn-ghost" href="./creator.html" aria-label="Customize character">Customize</a>
      </div>
    </div>
  </header>

  <main class="wrap layout">
    <!-- Stage: centered avatar on mobile -->
    <section class="stage card">
      <div id="pixelCharContainer" class="avatar-stage" aria-label="User avatar"></div>

      <div class="stage-controls">
        <label class="stack">
          <span class="label">Choose a Topic</span>
          <select id="topicSelect" class="select"></select>
        </label>
      </div>
    </section>

    <!-- Bottom Drawer: Problem / Streak / Keyboard (mobile), inline on desktop -->
    <section id="drawer" class="drawer card">
      <div class="prob-head">
        <h2>Problem</h2>
        <div class="streak" title="Correct in a row">ðŸ”¥ Streak: <span id="streakVal">0</span></div>
      </div>

      <div id="questionPrompt" class="prompt pretty">Pick a topic to begin.</div>

      <div class="answer-row">
        <input id="answerInput" type="text" inputmode="text" autocomplete="off" spellcheck="false"
               placeholder="Type your answerâ€¦ e.g., 3/4, DNE, âˆž, y=2x-3"/>
      </div>

      <div class="actions">
        <button id="checkBtn" class="btn btn-primary">Check</button>
        <button id="nextBtn" class="btn btn-ghost">Next</button>
        <button id="kbdToggle" class="btn btn-ghost only-mobile" aria-expanded="false" aria-controls="kbd">Keyboard</button>
      </div>

      <div id="feedback" class="feedback"></div>

      <!-- On-screen keyboard lives inside the drawer -->
      <div id="kbd" class="kbd">
        <div class="kbd-grid">
          <!-- row 1 -->
          <button data-ins="7">7</button><button data-ins="8">8</button><button data-ins="9">9</button>
          <button data-ins="(">(</button><button data-ins=")">)</button><button data-ins="^">^</button>
          <!-- row 2 -->
          <button data-ins="4">4</button><button data-ins="5">5</button><button data-ins="6">6</button>
          <button data-ins="+">+</button><button data-ins="-">-</button><button data-ins="Â±">Â±</button>
          <!-- row 3 -->
          <button data-ins="1">1</button><button data-ins="2">2</button><button data-ins="3">3</button>
          <button data-ins="*">*</button><button data-ins="/">/</button><button data-ins="=">=</button>
          <!-- row 4 -->
          <button data-ins="0" class="wide">0</button><button data-ins=".">.</button>
          <button data-ins="x">x</button><button data-ins="y">y</button><button data-ins="âˆž">âˆž</button><button data-ins="-âˆž">-âˆž</button>
          <!-- row 5 -->
          <button data-ins="DNE" class="accent">DNE</button>
          <button id="kbdBack" class="danger">âŒ«</button>
          <button id="kbdClear" class="danger">Clear</button>
          <button id="kbdEnter" class="primary">Check</button>
        </div>
      </div>
    </section>
  </main>

  <footer class="foot">
    <small>Static build â€” GitHub Pages</small>
  </footer>

  <!-- Slower XP float from feedback area -->
  <template id="xpFloatTpl">
    <div class="xp-float">+<span></span> XP</div>
  </template>

  <script type="module" src="./app.js"></script>
</body>
</html>
